This code is provided to reproduce the paper "Motion of objects embedded in lipid bilayer membranes: advection and effective viscosity" by Brian Camley and Frank Brown.

This code is hacked-together scientific code; it is not pretty, and could certainly be more efficient, but it serves to illustrate some of the detailed methods that cannot be captured within a paper and allow for easier reproduction of the results. We cannot guarantee that it performs as predicted if you try to change things without understanding them! In this sense, it is released in the spirit of the CRAPL license. 

This MATLAB code will require the folder "commoncode" to be present in the directory structure used here. Some of this code uses the Symbolic Math Toolbox.

To reproduce the figures:

Fig. 1 (flow around an inclusion): go to directory circleflow, run the script flow_around_circle_plot.m

Fig. 2 (comparison between RS and Faxen relationships): go to directory faxen_test and run velocity_faxen_relationship_test.m (May take ~5-10 minutes to run).

Fig. 3 (Trajectories of proteins embedded in flow): go to the directory trajectory_faxen and run compare_integrated_trajectories_plot.m -- you will have to change the "vext_sym" function to match the ambient flow you want to simulate in -- common flows including the ones in the papers are shown in the comments. This takes ~6 minutes on my desktop. The flow fields in Fig. 3CD are generated by the script in the folder laplacianplot

Fig. 4 (Intrinsic viscosities of circular proteins): go to the directory alphacircle, and run generate_intrinsic_viscosity_alpha_script.m -- by default this will load pre-existing data and plot from this. To rerun the simulation instead, change the flag "rerunsimulation" to "true" in the script. This computation will take a few hours.

Fig. 5 (Intrinsic viscosity of linear oligomers): The method of the main paper is in the folder alphaoligo -- run "generate_intrinsic_viscosity_alpha_script_oligo_restart.m". Again, by default this will load saved data to plot. To rerun, set rerunsimulation = true in the script. This will be very slow to finish, and I have let it run overnight in the past. There is also the grand resistance matrix method, which is in the "gr" folder, intrinsic_viscosity_nmer_GR.m, which will be significantly faster.
